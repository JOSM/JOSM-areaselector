<?xml version="1.0" encoding="utf-8"?>
<project name="areaselector" default="dist" basedir="." xmlns:ivy="antlib:org.apache.ivy.ant">

	<!-- enter the SVN commit message -->
	<property name="commit.message" value="Commit message" />
	<!-- enter the *lowest* JOSM version this plugin is currently compatible with -->
	<property name="plugin.main.version" value="11226" />

	<!-- Configure these properties (replace "..." accordingly).
         See https://josm.openstreetmap.de/wiki/DevelopersGuide/DevelopingPlugins
     -->

	<property name="plugin.author" value="Paul Woelfel, Thomas Konrad" />
	<property name="plugin.class" value="org.openstreetmap.josm.plugins.areaselector.AreaSelectorPlugin" />
	<property name="plugin.description" value="Allows selection of areas in an layer and automatic creation of a way as polygon. Built to ease mapping of building from background layers. Optimized for basemap.at." />
	<property name="plugin.icon" value="images/mapmode/areaselector.png" />
	<property name="plugin.link" value="https://github.com/JOSM/JOSM-areaselector"/>
	<property name="plugin.requires" value="log4j"/>

	<property name="josm" location="../../core/dist/josm-custom.jar" />
	<property name="plugin.dist.dir" value="../../dist" />
	
	<property name="plugin.canloadatruntime" value="true"/>
	
	<property name="lib.base" value="lib" />
	
	<path id="ivy.lib.path" path="ant/ivy-2.4.0.jar" />
	<taskdef resource="org/apache/ivy/ant/antlib.xml" uri="antlib:org.apache.ivy.ant" classpathref="ivy.lib.path" />

	<!-- ** include targets that all plugins have in common ** -->
	<import file="../build-common.xml" />

    <fileset id="plugin.requires.jars" dir="${plugin.dist.dir}">
        <include name="log4j.jar"/>
    </fileset>

	<!--
    **********************************************************
    ** compile - complies the source tree
    * and includes log4j.jar
    **********************************************************

    -->
	<target name="compile" depends="init, fetch_dependencies">
		<echo message="compiling sources for  ${plugin.jar} ... "/>
		<javac srcdir="src" classpath="${josm}" debug="true" destdir="${plugin.build.dir}" includeantruntime="false">
      <classpath>
          <pathelement location="${josm}"/>
        <fileset id="plugin.requires.jars" dir="${plugin.dist.dir}">
            <include name="log4j.jar"/>
        </fileset>
		<fileset dir="${lib.base}">
			<include name="*-custom.jar"/>
			<include name="*-jar.jar"/>
		</fileset>
        <fileset dir="${plugin.dist.dir}">
            <include name="austriaaddresshelper.jar"/>
        </fileset>

      </classpath>
			<compilerarg value="-Xlint:deprecation"/>
			<compilerarg value="-Xlint:unchecked"/>
		</javac>
	</target>
	
	<target name="fetch_dependencies" depends="clean_ivy">
		<ivy:retrieve pattern="${plugin.lib.dir}/[artifact]-[type].[ext]" conf="default" />
	</target>

	<target name="clean_ivy">
		<delete failonerror="false">
			<fileset dir="${lib.base}">
				<include name="**/*.jar"/>
				<exclude name="**/*-custom.jar" />
			</fileset>
		</delete>
	</target>

	<target name="installPlugin" depends="clean, dist, install">
		<echo>Installed areaselector plugin</echo>
	</target>
</project>
